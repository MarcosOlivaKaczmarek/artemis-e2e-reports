services:
  app:
    image: ghcr.io/marcosolivakaczmarek/artemis-e2e-reports:latest
    restart: always
    ports:
      - "3000:3000"
    volumes:
      - app-data:/data
    environment:
      - UPLOAD_TOKEN=${UPLOAD_TOKEN}
      - GITHUB_TOKEN=${GITHUB_TOKEN}
      - DB_PATH=/data/reports.db
      - DATA_DIR=/data
      - NEXTAUTH_URL=${NEXTAUTH_URL:-http://ba-oliva.aet.cit.tum.de}
      - NEXTAUTH_SECRET=${NEXTAUTH_SECRET}
      - GITHUB_CLIENT_ID=${GITHUB_CLIENT_ID}
      - GITHUB_CLIENT_SECRET=${GITHUB_CLIENT_SECRET}
      - AUTH_TRUST_HOST=true

  nginx:
    image: nginx:alpine
    restart: always
    ports:
      - "80:80"
    volumes:
      - ./nginx.conf:/etc/nginx/conf.d/default.conf:ro
    depends_on:
      - app

volumes:
  app-data:
